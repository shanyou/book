# Introduction
公司最近在做一个新的api网关，从原来的asp.net切换到了php，需要采集一些服务的性能指标数据。最初用的Ganglia, 因为有现成的插件，直接安装不需要开发。在使用的过程中发现Ganglia的指标组织太混乱，安装完插件后会有很多有用没用的指标都显示在一起。机器多了以后组织起来也比较麻烦。于是学摸着是否要改变一下现在的监控手段。

我们的服务器是阿里云的ECS虚拟机，本身阿里云也提供了不错的监控平台。一些系统的指标很容易监控。但是随着业务不多扩大，对一些自己开发的服务监控的需求也越来越大。Hadoop, Hbase群集监控也需要提高日程上来。一个月1千条短信报警提醒在某些时候貌似也不够用。这也促使着我们的监控手段要改变一下。

在以上几个问题驱动下，我们开始实践新的服务器指标监控的架构, opentsdb+collectd+grafana+nagios, 提起这几个组件估计运维人员都不会太陌生，对就是很大众化的一个监控解决方案，贵在技术都比较成熟。接下来本文就是围绕着这个架构，把工作中与到的一些问题与解决方法分享出来。
